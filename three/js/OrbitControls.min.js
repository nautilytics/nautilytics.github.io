THREE.OrbitControls = function (a, b) { function r() { return 2 * Math.PI / 60 / 60 * c.autoRotateSpeed } function s() { return Math.pow(.95, c.userZoomSpeed) } function t(a) { c.enabled !== !1 && c.userRotate !== !1 && p !== o.SEARCH && (a.preventDefault(), p === o.NONE && (0 === a.button && (p = o.ROTATE), 1 === a.button && (p = o.ZOOM), 2 === a.button && (p = o.PAN)), p === o.ROTATE ? f.set(a.clientX, a.clientY) : p === o.ZOOM ? i.set(a.clientX, a.clientY) : p === o.PAN, document.addEventListener("mousemove", u, !1), document.addEventListener("mouseup", v, !1)) } function u(a) { if (c.enabled !== !1 && p !== o.SEARCH) if (a.preventDefault(), p === o.ROTATE) g.set(a.clientX, a.clientY), h.subVectors(g, f), c.rotateLeft(2 * Math.PI * h.x / e * c.userRotateSpeed), c.rotateUp(2 * Math.PI * h.y / e * c.userRotateSpeed), f.copy(g); else if (p === o.ZOOM) j.set(a.clientX, a.clientY), k.subVectors(j, i), k.y > 0 ? c.zoomIn() : c.zoomOut(), i.copy(j); else if (p === o.PAN) { var b = a.movementX || a.mozMovementX || a.webkitMovementX || 0, d = a.movementY || a.mozMovementY || a.webkitMovementY || 0; c.pan(new THREE.Vector3(-b, d, 0)) } } function v() { c.enabled !== !1 && c.userRotate !== !1 && p !== o.SEARCH && (document.removeEventListener("mousemove", u, !1), document.removeEventListener("mouseup", v, !1), p = o.NONE) } function w(a) { if (c.enabled !== !1 && c.userZoom !== !1 && p !== o.SEARCH) { var b = 0; a.wheelDelta ? b = a.wheelDelta : a.detail && (b = -a.detail), b > 0 ? c.zoomOut() : c.zoomIn() } } function x(a) { if (p !== o.SEARCH && c.enabled !== !1 && c.userPan !== !1) switch (a.keyCode) { case c.keys.ROTATE: p = o.ROTATE; break; case c.keys.ZOOM: p = o.ZOOM; break; case c.keys.PAN: p = o.PAN } } function y(a) { if (p !== o.SEARCH) switch (a.keyCode) { case c.keys.ROTATE: case c.keys.ZOOM: case c.keys.PAN: p = o.NONE } } this.object = a, this.domElement = void 0 !== b ? b : document, this.enabled = !0, this.center = new THREE.Vector3, this.userZoom = !0, this.userZoomSpeed = 1, this.userRotate = !0, this.userRotateSpeed = 1, this.userPan = !0, this.userPanSpeed = 2, this.autoRotate = !1, this.autoRotateSpeed = 2, this.minPolarAngle = 0, this.maxPolarAngle = Math.PI, this.minDistance = 0, this.maxDistance = 1 / 0, this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40, ROTATE: 65, ZOOM: 83, PAN: 68 }; var c = this, d = 1e-6, e = 1800, f = new THREE.Vector2, g = new THREE.Vector2, h = new THREE.Vector2, i = new THREE.Vector2, j = new THREE.Vector2, k = new THREE.Vector2, l = 0; this.thetaDelta = 0; var m = 1, n = new THREE.Vector3, o = { NONE: -1, ROTATE: 0, ZOOM: 1, PAN: 2, TWEEN: 3, SEARCH: 4 }, p = o.NONE, q = { type: "change" }; this.rotateLeft = function (a) { void 0 === a && (a = r()), this.thetaDelta -= a }, this.rotateRight = function (a) { void 0 === a && (a = r()), this.thetaDelta += a }, this.rotateUp = function (a) { void 0 === a && (a = r()), l -= a }, this.rotateDown = function (a) { void 0 === a && (a = r()), l += a }, this.zoomIn = function (a) { void 0 === a && (a = s()), m /= a }, this.zoomOut = function (a) { void 0 === a && (a = s()), m *= a }, this.pan = function (a) { a.transformDirection(this.object.matrix), a.multiplyScalar(c.userPanSpeed), this.object.position.add(a), this.center.add(a) }, this.update = function () { if (p !== o.SEARCH && p != o.TWEEN) { var a = this.object.position, b = a.clone().sub(this.center), c = Math.atan2(b.x, b.z), e = Math.atan2(Math.sqrt(b.x * b.x + b.z * b.z), b.y); this.autoRotate && this.rotateLeft(r()), c += this.thetaDelta, e += l, e = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, e)), e = Math.max(d, Math.min(Math.PI - d, e)); var f = b.length() * m; f = Math.max(this.minDistance, Math.min(this.maxDistance, f)), b.x = f * Math.sin(e) * Math.sin(c), b.y = f * Math.cos(e), b.z = f * Math.sin(e) * Math.cos(c), a.copy(this.center).add(b), this.object.lookAt(this.center), this.thetaDelta = 0, l = 0, m = 1, n.distanceTo(this.object.position) > 0 && (this.dispatchEvent(q), n.copy(this.object.position)) } }, this.setTweening = function (a) { p !== o.SEARCH && (p = a ? o.TWEEN : o.NONE) }, this.setSearching = function (a) { p = a ? o.SEARCH : o.NONE }, this.setTweenedPosition = function (a) { var b = this.object.position, c = Math.sqrt(2 ^ (b.x ^ 2 + b.z)); Math.atan2(c, b.y); var e = a; b.x = c * Math.sin(e), b.z = c * Math.cos(e) }, this.domElement.addEventListener("contextmenu", function (a) { a.preventDefault() }, !1), this.domElement.addEventListener("mousedown", t, !1), this.domElement.addEventListener("mousewheel", w, !1), this.domElement.addEventListener("DOMMouseScroll", w, !1), window.addEventListener("keydown", x, !1), window.addEventListener("keyup", y, !1) }, THREE.OrbitControls.prototype = Object.create(THREE.EventDispatcher.prototype);